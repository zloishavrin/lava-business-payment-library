# lava-business-payment-library-nodejs

![LAVA-PAYMENT](https://i.ibb.co/XDn8frs/23-1.png)

Неоффициальная библиотека для работы с платежной системой LAVA. Оффициальная документация для работы с API доступна по [ссылке](https://dev.lava.ru/).

## Установка

Установить можно используя менеджеры пакетов, например, npm:

```javascript
npm install zloishavrin/lava-business-payment-library
```

Подключение в проект:

```javascript
const { LavaPayment } = require('lava-payment');
```

## Использование

Реализованы все методы доступные в API LAVA BUSINESS.

### Создание экземпляра класса

Следует передать в конструктор идентификатор проекта, API-ключ и доменное имя (если не указано, то дефолтное значение 'ru').

```javascript
const lavaApi = new LavaPayment(SHOP_ID, API_KEY, DOMAIN_NAME);
```

### Создание вывода

Обязательно указываются сумма вывода, уникальный идентификатор платежа в системе мерчанта, идентификатор проекта (если был указан в конструкторе, то не обязательно указывать в методе).

```javascript
lavaApi.createPayoff({

  shopId: SHOP_ID,
  amount: AMOUNT,
  orderId: new Date().getTime()

})
```

### Запрос на получение информации о выводе

Обязательно указывается также уникальный идентификатор проекта в Lava (если был указан в конструкторе, то не обязательно указывать в методе). Также обязательно указать уникальный идентификатор платежа в системе мерчанта (orderId) или номер вывода (payoffId).

```javascript
lavaApi.payoffInfo({

  shopId: SHOP_ID,
  orderId: new Date().getTime(),
  payoffId: PAYOFF_ID

})
```

### Запрос на получение тарифов на вывод средств

Обязательно указывается также уникальный идентификатор проекта в Lava (если был указан в конструкторе, то не обязательно указывать в методе).

```javascript
lavaApi.getTariffsPayoff(SHOP_ID)
```

### Создание счета

Обязательно указываются сумма на которую выставляется счёт, идентификатор проекта (если был указан в конструкторе, то не обязательно указывать в методе), уникальный идентификатор платежа в системе мерчанта (можно использовать Date()).

```javascript
lavaApi.createInvoice({

  shopId: SHOP_ID,
  sum: SUM,
  orderId: new Date().getTime()

})
```

### Статус счета

Обязательно указываются уникальный идентификатор проекта в Lava (если был указан в конструкторе, то не обязательно указывать в методе). Также обязательно указать уникальный идентификатор платежа в системе мерчанта (orderId) или идентификатор инвойса (invoiceId).

```javascript
lavaApi.statusInvoice({

  shopId: SHOP_ID,
  invoiceId: INVOICE_ID,
  orderId: ORDER_ID

})
```

### Получение списка методов оплаты

Обязательно указываются уникальный идентификатор проекта в Lava (если был указан в конструкторе, то не обязательно указывать в методе).

```javascript
lavaApi.getAvailableTariffs(SHOP_ID)
```

### Получение баланса магазина

Обязательно указываются уникальный идентификатор проекта в Lava (если был указан в конструкторе, то не обязательно указывать в методе).

```javascript
lavaApi.getBalance(SHOP_ID)
```

## Зависимости

Key|Value
:-----------:|:--------------------------------------------:
axios|Для запросов к LAVA API
crypto|Пакет нужен для реализации метода создания сигнатуры
